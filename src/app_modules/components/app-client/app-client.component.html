<div class="app-client">

    <div class="autocss">
        <h1>Client</h1>
    </div>


    <modal v-if="controller.stage == 'connect'" title="Join Game" css="autocss">
        <label>
            <span>Connect to</span>
            <input type="text" v-model="controller.serverKey" @keyup.enter="controller.connect"/>
        </label>
        <button @click="controller.connect">Connect</button>
    </modal>

    <modal v-if="controller.stage == 'register'" title="Register Character" css="autocss">
        <p>You successfully connected to server.</p>
        <label>
            <span>Select Nickname</span>
            <input type="text" v-model="controller.playerName" @keyup.enter="controller.register"/>
        </label>
        <label>
            <span>Select Team</span>
            <ul class="select">
                <li @click="activeTeam = 'red'" :class="{active: activeTeam == 'red'}">{{controller.levelParams.redTeamName}}</li>
                <li @click="activeTeam = 'blue'" :class="{active: activeTeam == 'blue'}">{{controller.levelParams.blueTeamName}}</li>
            </ul>
        </label>
        <label>
            <span>Select Weapon</span>
            <ul class="select">
                <li v-for="(isAvailable, key) in controller.availableWeapons" v-if="isAvailable"
                    @click="chosenWeapon = key"
                    :class="{active: chosenWeapon === key}">{{key}}
                </li>
            </ul>
        </label>
        <button @click="controller.register">Register</button>
    </modal>

    <div class="autocss" v-if="controller.stage == 'play'">
        <div class="info">
            <label>
                <span>Current state</span>
                <strong>Ready!</strong>
            </label>
            <label>
                <span>Player name</span>
                <strong>{{controller.playerName}}</strong>
            </label>
            <label>
                <span>Server ID</span>
                <strong>{{controller.serverId}}</strong>
            </label>
        </div>

        <div v-if="controller.levelRef">
            <input class="focusInput" type="text"
                   @keydown.stop.prevent.87="handleWDown"
                   @keyup.stop.prevent.87="handleWUp"
                   @keydown.stop.prevent.68="handleDDown"
                   @keyup.stop.prevent.68="handleDUp"
                   @keydown.stop.prevent.65="handleADown"
                   @keyup.stop.prevent.65="handleAUp"
                   @keydown.stop.prevent.83="handleSDown"
                   @keyup.stop.prevent.83="handleSUp"
                   @keydown.stop.prevent.16="handleShiftDown"
                   @keyup.stop.prevent.16="handleShiftUp"
                   @keydown.stop.prevent.69="handleActionFireStart"
                   @keyup.stop.prevent.69="handleActionFireStop"/>
            <hr/>
            <clientgamefield :controller="controller"
                             @pointerupdate="handlePointer"
                             @pointerrightdown="handleActionFireStart"
                             @pointerrightup="handleActionFireStop"/>
        </div>
    </div>

</div>
